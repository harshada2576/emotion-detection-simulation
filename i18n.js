class I18n {
    static languages = {
        en: {
            // App & Navigation
            appTitle: "🧠 Emotion Detection & Mental Health Assistant",
            appSubtitle: "Project #70: AI-Powered Emotional Support System",
            howAreYouFeeling: "How are you feeling today?",
            
            // Input Methods
            describeFeelings: "💬 Describe your feelings",
            speakFeelings: "🎤 Speak your feelings",
            selectExpression: "😊 Select facial expression",
            webcamAnalysis: "📷 Real-time Analysis",
            textInputPlaceholder: "Tell me how you're feeling today...",
            analyzeEmotion: "Analyze Emotion",
            advancedAnalysis: "Advanced Analysis",
            startRecording: "🎤 Start Recording",
            stopRecording: "⏹️ Stop Recording",
            voiceInstructions: "Click 'Start Recording' and speak about your feelings",
            startCamera: "🎥 Start Camera",
            captureEmotion: "📸 Capture Emotion",
            cameraInstructions: "Enable camera for real-time facial analysis",
            
            // Emotions
            happy: "Happy",
            sad: "Sad", 
            angry: "Angry",
            surprised: "Surprised",
            neutral: "Neutral",
            anxious: "Anxious",
            
            // Results
            analysisResults: "Emotion Analysis Results",
            emotionalBreakdown: "Emotional Breakdown:",
            supportiveResponse: "💭 Supportive Response",
            suggestionsTitle: "💡 Suggestions for emotional well-being:",
            
            // Progress Tracking
            progressTitle: "📈 Your Progress",
            dayStreak: "Day Streak",
            sessions: "Sessions",
            achievements: "Achievements",
            
            // Mental Health Exercises
            mentalHealthExercises: "🧘 Mental Health Exercises",
            breathingExercise: "Breathing Exercise",
            breathingDescription: "4-7-8 breathing technique for anxiety relief",
            quickMeditation: "Quick Meditation",
            meditationDescription: "5-minute mindfulness practice",
            progressiveRelaxation: "Progressive Relaxation",
            pmrDescription: "Progressive muscle relaxation technique",
            cbtExercise: "CBT Thought Record",
            cbtDescription: "Cognitive Behavioral Therapy exercise",
            guidedJournaling: "Guided Journaling",
            journalDescription: "Structured emotional reflection",
            groundingExercise: "Grounding Technique",
            groundingDescription: "5-4-3-2-1 sensory grounding",
            startExercise: "Start Exercise",
            stopExercise: "Stop Exercise",
            
            // Analytics
            analyticsTitle: "📊 Emotional Trends & Analytics",
            last7Days: "Last 7 Days",
            last30Days: "Last 30 Days", 
            last90Days: "Last 90 Days",
            exportData: "📤 Export Data",
            weeklyMood: "Weekly Mood Distribution",
            emotionFrequency: "Emotion Frequency",
            emotionalTrends: "📈 Emotional Trends Over Time",
            moodHeatmap: "🎨 Mood Heatmap",
            communityInsights: "👥 Community Insights",
            generateReport: "📄 Generate RPA Report",
            scheduleReport: "⏰ Schedule Reports",
            
            // Session Info
            sessionStarted: "Session started:",
            interactions: "Interactions:",
            currentStreak: "Current Streak:",
            resetSession: "🔄 Reset Session",
            
            // Community Messages
            defaultCommunityMessage: "You're not alone in your emotional journey. Many people find comfort in daily check-ins.",
            
            // No Data
            noData: "No data yet"
        },
        
        es: {
            // App & Navigation
            appTitle: "🧠 Asistente de Detección de Emociones y Salud Mental",
            appSubtitle: "Proyecto #70: Sistema de Apoyo Emocional con IA",
            howAreYouFeeling: "¿Cómo te sientes hoy?",
            
            // Input Methods
            describeFeelings: "💬 Describe tus sentimientos",
            speakFeelings: "🎤 Habla sobre tus sentimientos", 
            selectExpression: "😊 Selecciona expresión facial",
            webcamAnalysis: "📷 Análisis en Tiempo Real",
            textInputPlaceholder: "Cuéntame cómo te sientes hoy...",
            analyzeEmotion: "Analizar Emoción",
            advancedAnalysis: "Análisis Avanzado",
            startRecording: "🎤 Comenzar Grabación",
            stopRecording: "⏹️ Detener Grabación",
            voiceInstructions: "Haz clic en 'Comenzar Grabación' y habla sobre tus sentimientos",
            startCamera: "🎥 Encender Cámara",
            captureEmotion: "📸 Capturar Emoción",
            cameraInstructions: "Habilita la cámara para análisis facial en tiempo real",
            
            // Emotions
            happy: "Feliz",
            sad: "Triste",
            angry: "Enojado", 
            surprised: "Sorprendido",
            neutral: "Neutral",
            anxious: "Ansioso",
            
            // Results
            analysisResults: "Resultados del Análisis Emocional",
            emotionalBreakdown: "Desglose Emocional:",
            supportiveResponse: "💭 Respuesta de Apoyo",
            suggestionsTitle: "💡 Sugerencias para el bienestar emocional:",
            
            // Progress Tracking
            progressTitle: "📈 Tu Progreso",
            dayStreak: "Racha de Días",
            sessions: "Sesiones",
            achievements: "Logros",
            
            // Mental Health Exercises
            mentalHealthExercises: "🧘 Ejercicios de Salud Mental",
            breathingExercise: "Ejercicio de Respiración",
            breathingDescription: "Técnica de respiración 4-7-8 para aliviar la ansiedad",
            quickMeditation: "Meditación Rápida", 
            meditationDescription: "Práctica de mindfulness de 5 minutos",
            progressiveRelaxation: "Relajación Progresiva",
            pmrDescription: "Técnica de relajación muscular progresiva",
            cbtExercise: "Registro de Pensamientos TCC",
            cbtDescription: "Ejercicio de Terapia Cognitivo-Conductual",
            guidedJournaling: "Diario Guiado",
            journalDescription: "Reflexión emocional estructurada",
            groundingExercise: "Técnica de Grounding",
            groundingDescription: "Grounding sensorial 5-4-3-2-1",
            startExercise: "Comenzar Ejercicio",
            stopExercise: "Detener Ejercicio",
            
            // Analytics
            analyticsTitle: "📊 Tendencias y Análisis Emocionales",
            last7Days: "Últimos 7 Días",
            last30Days: "Últimos 30 Días",
            last90Days: "Últimos 90 Días", 
            exportData: "📤 Exportar Datos",
            weeklyMood: "Distribución Semanal del Estado de Ánimo",
            emotionFrequency: "Frecuencia de Emociones",
            emotionalTrends: "📈 Tendencias Emocionales en el Tiempo",
            moodHeatmap: "🎨 Mapa de Calor del Estado de Ánimo",
            communityInsights: "👥 Perspectivas de la Comunidad",
            generateReport: "📄 Generar Informe RPA",
            scheduleReport: "⏰ Programar Informes",
            
            // Session Info
            sessionStarted: "Sesión iniciada:",
            interactions: "Interacciones:",
            currentStreak: "Racha Actual:",
            resetSession: "🔄 Reiniciar Sesión",
            
            // Community Messages
            defaultCommunityMessage: "No estás solo en tu viaje emocional. Muchas personas encuentran consuelo en los chequeos diarios.",
            
            // No Data
            noData: "Sin datos aún"
        },
        
        fr: {
            // App & Navigation
            appTitle: "🧠 Assistant de Détection des Émotions et de Santé Mentale",
            appSubtitle: "Projet #70: Système de Soutien Émotionnel avec IA",
            howAreYouFeeling: "Comment vous sentez-vous aujourd'hui ?",
            
            // Input Methods
            describeFeelings: "💬 Décrivez vos sentiments",
            speakFeelings: "🎤 Parlez de vos sentiments",
            selectExpression: "😊 Sélectionnez une expression faciale", 
            webcamAnalysis: "📷 Analyse en Temps Réel",
            textInputPlaceholder: "Dites-moi comment vous vous sentez aujourd'hui...",
            analyzeEmotion: "Analyser l'Émotion",
            advancedAnalysis: "Analyse Avancée",
            startRecording: "🎤 Démarrer l'Enregistrement",
            stopRecording: "⏹️ Arrêter l'Enregistrement",
            voiceInstructions: "Cliquez sur 'Démarrer l'Enregistrement' et parlez de vos sentiments",
            startCamera: "🎥 Activer la Caméra",
            captureEmotion: "📸 Capturer l'Émotion",
            cameraInstructions: "Activez la caméra pour l'analyse faciale en temps réel",
            
            // Emotions
            happy: "Heureux",
            sad: "Triste",
            angry: "En colère",
            surprised: "Surpris", 
            neutral: "Neutre",
            anxious: "Anxieux",
            
            // Results
            analysisResults: "Résultats de l'Analyse Émotionnelle",
            emotionalBreakdown: "Répartition Émotionnelle :",
            supportiveResponse: "💭 Réponse de Soutien",
            suggestionsTitle: "💡 Suggestions pour le bien-être émotionnel :",
            
            // Progress Tracking
            progressTitle: "📈 Votre Progrès",
            dayStreak: "Série de Jours",
            sessions: "Sessions", 
            achievements: "Réalisations",
            
            // Mental Health Exercises
            mentalHealthExercises: "🧘 Exercices de Santé Mentale",
            breathingExercise: "Exercice de Respiration",
            breathingDescription: "Technique de respiration 4-7-8 pour soulager l'anxiété",
            quickMeditation: "Méditation Rapide",
            meditationDescription: "Pratique de pleine conscience de 5 minutes",
            progressiveRelaxation: "Relaxation Progressive",
            pmrDescription: "Technique de relaxation musculaire progressive",
            cbtExercise: "Journal des Pensées TCC",
            cbtDescription: "Exercice de Thérapie Cognitivo-Comportementale",
            guidedJournaling: "Journal Guidé",
            journalDescription: "Réflexion émotionnelle structurée",
            groundingExercise: "Technique de Grounding", 
            groundingDescription: "Grounding sensoriel 5-4-3-2-1",
            startExercise: "Commencer l'Exercice",
            stopExercise: "Arrêter l'Exercice",
            
            // Analytics
            analyticsTitle: "📊 Tendances et Analyses Émotionnelles",
            last7Days: "7 Derniers Jours",
            last30Days: "30 Derniers Jours",
            last90Days: "90 Derniers Jours",
            exportData: "📤 Exporter les Données",
            weeklyMood: "Distribution Hebdomadaire de l'Humeur",
            emotionFrequency: "Fréquence des Émotions",
            emotionalTrends: "📈 Tendances Émotionnelles dans le Temps",
            moodHeatmap: "🎨 Carte de Chaleur de l'Humeur",
            communityInsights: "👥 Perspectives Communautaires",
            generateReport: "📄 Générer un Rapport RPA",
            scheduleReport: "⏰ Planifier les Rapports",
            
            // Session Info  
            sessionStarted: "Session démarrée :",
            interactions: "Interactions :",
            currentStreak: "Série Actuelle :",
            resetSession: "🔄 Réinitialiser la Session",
            
            // Community Messages
            defaultCommunityMessage: "Vous n'êtes pas seul dans votre parcours émotionnel. Beaucoup de personnes trouvent du réconfort dans les bilans quotidiens.",
            
            // No Data
            noData: "Pas encore de données"
        },
        
        de: {
            // App & Navigation  
            appTitle: "🧠 Emotionserkennungs- und Mental Health-Assistent",
            appSubtitle: "Projekt #70: KI-gestütztes emotionales Unterstützungssystem",
            howAreYouFeeling: "Wie fühlst du dich heute?",
            
            // Input Methods
            describeFeelings: "💬 Beschreibe deine Gefühle",
            speakFeelings: "🎤 Sprich über deine Gefühle",
            selectExpression: "😊 Wähle einen Gesichtsausdruck",
            webcamAnalysis: "📷 Echtzeit-Analyse",
            textInputPlaceholder: "Erzähle mir, wie du dich heute fühlst...",
            analyzeEmotion: "Emotion analysieren",
            advancedAnalysis: "Erweiterte Analyse", 
            startRecording: "🎤 Aufnahme starten",
            stopRecording: "⏹️ Aufnahme stoppen",
            voiceInstructions: "Klicke auf 'Aufnahme starten' und sprich über deine Gefühle",
            startCamera: "🎥 Kamera starten",
            captureEmotion: "📸 Emotion erfassen",
            cameraInstructions: "Aktiviere die Kamera für Echtzeit-Gesichtsanalyse",
            
            // Emotions
            happy: "Glücklich",
            sad: "Traurig",
            angry: "Wütend",
            surprised: "Überrascht", 
            neutral: "Neutral",
            anxious: "Ängstlich",
            
            // Results
            analysisResults: "Emotionsanalyse-Ergebnisse",
            emotionalBreakdown: "Emotionale Aufschlüsselung:",
            supportiveResponse: "💭 Unterstützende Antwort",
            suggestionsTitle: "💡 Vorschläge für emotionales Wohlbefinden:",
            
            // Progress Tracking
            progressTitle: "📈 Dein Fortschritt",
            dayStreak: "Tage in Folge",
            sessions: "Sitzungen",
            achievements: "Erfolge",
            
            // Mental Health Exercises
            mentalHealthExercises: "🧘 Mental Health-Übungen",
            breathingExercise: "Atemübung",
            breathingDescription: "4-7-8 Atemtechnik zur Linderung von Angstzuständen",
            quickMeditation: "Schnelle Meditation",
            meditationDescription: "5-minütige Achtsamkeitspraxis",
            progressiveRelaxation: "Progressive Entspannung",
            pmrDescription: "Technik der progressiven Muskelentspannung",
            cbtExercise: "KVT Gedankenprotokoll",
            cbtDescription: "Kognitiv-Verhaltenstherapie Übung",
            guidedJournaling: "Geführtes Journaling",
            journalDescription: "Strukturierte emotionale Reflexion",
            groundingExercise: "Grounding-Technik",
            groundingDescription: "5-4-3-2-1 sensorisches Grounding",
            startExercise: "Übung starten",
            stopExercise: "Übung stoppen",
            
            // Analytics
            analyticsTitle: "📊 Emotionale Trends & Analysen",
            last7Days: "Letzte 7 Tage",
            last30Days: "Letzte 30 Tage",
            last90Days: "Letzte 90 Tage",
            exportData: "📤 Daten exportieren",
            weeklyMood: "Wöchentliche Stimmungsverteilung",
            emotionFrequency: "Emotionshäufigkeit",
            emotionalTrends: "📈 Emotionale Trends im Zeitverlauf",
            moodHeatmap: "🎨 Stimmungs-Hitmap",
            communityInsights: "👥 Community-Einblicke",
            generateReport: "📄 RPA-Bericht generieren",
            scheduleReport: "⏰ Berichte planen",
            
            // Session Info
            sessionStarted: "Sitzung gestartet:",
            interactions: "Interaktionen:",
            currentStreak: "Aktuelle Serie:",
            resetSession: "🔄 Sitzung zurücksetzen",
            
            // Community Messages
            defaultCommunityMessage: "Du bist nicht allein auf deiner emotionalen Reise. Viele Menschen finden Trost in täglichen Check-ins.",
            
            // No Data
            noData: "Noch keine Daten"
        }
    };

    static currentLanguage = 'en';
    static initialized = false;

    static init() {
        if (this.initialized) return;
        
        // Load saved language preference
        const savedLanguage = localStorage.getItem('preferredLanguage');
        if (savedLanguage && this.languages[savedLanguage]) {
            this.currentLanguage = savedLanguage;
        }
        
        // Set language selector
        const selector = document.getElementById('languageSelector');
        if (selector) {
            selector.value = this.currentLanguage;
            selector.addEventListener('change', (e) => {
                this.setLanguage(e.target.value);
            });
        }
        
        this.updateAllText();
        this.initialized = true;
    }

    static setLanguage(lang) {
        if (!this.languages[lang]) {
            console.warn(`Language ${lang} not supported`);
            return;
        }
        
        this.currentLanguage = lang;
        localStorage.setItem('preferredLanguage', lang);
        
        // Update selector if exists
        const selector = document.getElementById('languageSelector');
        if (selector) {
            selector.value = lang;
        }
        
        this.updateAllText();
        
        // Announce language change for accessibility
        AccessibilityManager.announce(`Language changed to ${this.getLanguageName(lang)}`);
    }

    static updateAllText() {
        // Update all elements with data-i18n attribute
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            const translation = this.t(key);
            if (translation) {
                element.textContent = translation;
            }
        });

        // Update placeholder texts
        document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
            const key = element.getAttribute('data-i18n-placeholder');
            const translation = this.t(key);
            if (translation) {
                element.setAttribute('placeholder', translation);
            }
        });

        // Update page title
        const title = this.t('appTitle');
        if (title) {
            document.title = title.replace(/^🧠\s*/, '');
        }
    }

    static t(key) {
        const keys = key.split('.');
        let value = this.languages[this.currentLanguage];
        
        for (const k of keys) {
            if (value && value[k] !== undefined) {
                value = value[k];
            } else {
                console.warn(`Translation key not found: ${key}`);
                return key; // Return the key itself if translation not found
            }
        }
        
        return value;
    }

    static getLanguageName(code) {
        const names = {
            en: 'English',
            es: 'Spanish',
            fr: 'French',
            de: 'German'
        };
        return names[code] || code;
    }

    static getSupportedLanguages() {
        return Object.keys(this.languages);
    }

    static format(text, ...args) {
        return text.replace(/{(\d+)}/g, (match, number) => {
            return typeof args[number] != 'undefined' ? args[number] : match;
        });
    }
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    I18n.init();
});