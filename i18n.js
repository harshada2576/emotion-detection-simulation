class I18n {
    static languages = {
        en: {
            // App & Navigation
            appTitle: "ğŸ§  Emotion Detection & Mental Health Assistant",
            appSubtitle: "Project #70: AI-Powered Emotional Support System",
            howAreYouFeeling: "How are you feeling today?",
            
            // Input Methods
            describeFeelings: "ğŸ’¬ Describe your feelings",
            speakFeelings: "ğŸ¤ Speak your feelings",
            selectExpression: "ğŸ˜Š Select facial expression",
            webcamAnalysis: "ğŸ“· Real-time Analysis",
            textInputPlaceholder: "Tell me how you're feeling today...",
            analyzeEmotion: "Analyze Emotion",
            advancedAnalysis: "Advanced Analysis",
            startRecording: "ğŸ¤ Start Recording",
            stopRecording: "â¹ï¸ Stop Recording",
            voiceInstructions: "Click 'Start Recording' and speak about your feelings",
            startCamera: "ğŸ¥ Start Camera",
            captureEmotion: "ğŸ“¸ Capture Emotion",
            cameraInstructions: "Enable camera for real-time facial analysis",
            
            // Emotions
            happy: "Happy",
            sad: "Sad", 
            angry: "Angry",
            surprised: "Surprised",
            neutral: "Neutral",
            anxious: "Anxious",
            
            // Results
            analysisResults: "Emotion Analysis Results",
            emotionalBreakdown: "Emotional Breakdown:",
            supportiveResponse: "ğŸ’­ Supportive Response",
            suggestionsTitle: "ğŸ’¡ Suggestions for emotional well-being:",
            
            // Progress Tracking
            progressTitle: "ğŸ“ˆ Your Progress",
            dayStreak: "Day Streak",
            sessions: "Sessions",
            achievements: "Achievements",
            
            // Mental Health Exercises
            mentalHealthExercises: "ğŸ§˜ Mental Health Exercises",
            breathingExercise: "Breathing Exercise",
            breathingDescription: "4-7-8 breathing technique for anxiety relief",
            quickMeditation: "Quick Meditation",
            meditationDescription: "5-minute mindfulness practice",
            progressiveRelaxation: "Progressive Relaxation",
            pmrDescription: "Progressive muscle relaxation technique",
            cbtExercise: "CBT Thought Record",
            cbtDescription: "Cognitive Behavioral Therapy exercise",
            guidedJournaling: "Guided Journaling",
            journalDescription: "Structured emotional reflection",
            groundingExercise: "Grounding Technique",
            groundingDescription: "5-4-3-2-1 sensory grounding",
            startExercise: "Start Exercise",
            stopExercise: "Stop Exercise",
            
            // Analytics
            analyticsTitle: "ğŸ“Š Emotional Trends & Analytics",
            last7Days: "Last 7 Days",
            last30Days: "Last 30 Days", 
            last90Days: "Last 90 Days",
            exportData: "ğŸ“¤ Export Data",
            weeklyMood: "Weekly Mood Distribution",
            emotionFrequency: "Emotion Frequency",
            emotionalTrends: "ğŸ“ˆ Emotional Trends Over Time",
            moodHeatmap: "ğŸ¨ Mood Heatmap",
            communityInsights: "ğŸ‘¥ Community Insights",
            generateReport: "ğŸ“„ Generate RPA Report",
            scheduleReport: "â° Schedule Reports",
            
            // Session Info
            sessionStarted: "Session started:",
            interactions: "Interactions:",
            currentStreak: "Current Streak:",
            resetSession: "ğŸ”„ Reset Session",
            
            // Community Messages
            defaultCommunityMessage: "You're not alone in your emotional journey. Many people find comfort in daily check-ins.",
            
            // No Data
            noData: "No data yet"
        },
        
        es: {
            // App & Navigation
            appTitle: "ğŸ§  Asistente de DetecciÃ³n de Emociones y Salud Mental",
            appSubtitle: "Proyecto #70: Sistema de Apoyo Emocional con IA",
            howAreYouFeeling: "Â¿CÃ³mo te sientes hoy?",
            
            // Input Methods
            describeFeelings: "ğŸ’¬ Describe tus sentimientos",
            speakFeelings: "ğŸ¤ Habla sobre tus sentimientos", 
            selectExpression: "ğŸ˜Š Selecciona expresiÃ³n facial",
            webcamAnalysis: "ğŸ“· AnÃ¡lisis en Tiempo Real",
            textInputPlaceholder: "CuÃ©ntame cÃ³mo te sientes hoy...",
            analyzeEmotion: "Analizar EmociÃ³n",
            advancedAnalysis: "AnÃ¡lisis Avanzado",
            startRecording: "ğŸ¤ Comenzar GrabaciÃ³n",
            stopRecording: "â¹ï¸ Detener GrabaciÃ³n",
            voiceInstructions: "Haz clic en 'Comenzar GrabaciÃ³n' y habla sobre tus sentimientos",
            startCamera: "ğŸ¥ Encender CÃ¡mara",
            captureEmotion: "ğŸ“¸ Capturar EmociÃ³n",
            cameraInstructions: "Habilita la cÃ¡mara para anÃ¡lisis facial en tiempo real",
            
            // Emotions
            happy: "Feliz",
            sad: "Triste",
            angry: "Enojado", 
            surprised: "Sorprendido",
            neutral: "Neutral",
            anxious: "Ansioso",
            
            // Results
            analysisResults: "Resultados del AnÃ¡lisis Emocional",
            emotionalBreakdown: "Desglose Emocional:",
            supportiveResponse: "ğŸ’­ Respuesta de Apoyo",
            suggestionsTitle: "ğŸ’¡ Sugerencias para el bienestar emocional:",
            
            // Progress Tracking
            progressTitle: "ğŸ“ˆ Tu Progreso",
            dayStreak: "Racha de DÃ­as",
            sessions: "Sesiones",
            achievements: "Logros",
            
            // Mental Health Exercises
            mentalHealthExercises: "ğŸ§˜ Ejercicios de Salud Mental",
            breathingExercise: "Ejercicio de RespiraciÃ³n",
            breathingDescription: "TÃ©cnica de respiraciÃ³n 4-7-8 para aliviar la ansiedad",
            quickMeditation: "MeditaciÃ³n RÃ¡pida", 
            meditationDescription: "PrÃ¡ctica de mindfulness de 5 minutos",
            progressiveRelaxation: "RelajaciÃ³n Progresiva",
            pmrDescription: "TÃ©cnica de relajaciÃ³n muscular progresiva",
            cbtExercise: "Registro de Pensamientos TCC",
            cbtDescription: "Ejercicio de Terapia Cognitivo-Conductual",
            guidedJournaling: "Diario Guiado",
            journalDescription: "ReflexiÃ³n emocional estructurada",
            groundingExercise: "TÃ©cnica de Grounding",
            groundingDescription: "Grounding sensorial 5-4-3-2-1",
            startExercise: "Comenzar Ejercicio",
            stopExercise: "Detener Ejercicio",
            
            // Analytics
            analyticsTitle: "ğŸ“Š Tendencias y AnÃ¡lisis Emocionales",
            last7Days: "Ãšltimos 7 DÃ­as",
            last30Days: "Ãšltimos 30 DÃ­as",
            last90Days: "Ãšltimos 90 DÃ­as", 
            exportData: "ğŸ“¤ Exportar Datos",
            weeklyMood: "DistribuciÃ³n Semanal del Estado de Ãnimo",
            emotionFrequency: "Frecuencia de Emociones",
            emotionalTrends: "ğŸ“ˆ Tendencias Emocionales en el Tiempo",
            moodHeatmap: "ğŸ¨ Mapa de Calor del Estado de Ãnimo",
            communityInsights: "ğŸ‘¥ Perspectivas de la Comunidad",
            generateReport: "ğŸ“„ Generar Informe RPA",
            scheduleReport: "â° Programar Informes",
            
            // Session Info
            sessionStarted: "SesiÃ³n iniciada:",
            interactions: "Interacciones:",
            currentStreak: "Racha Actual:",
            resetSession: "ğŸ”„ Reiniciar SesiÃ³n",
            
            // Community Messages
            defaultCommunityMessage: "No estÃ¡s solo en tu viaje emocional. Muchas personas encuentran consuelo en los chequeos diarios.",
            
            // No Data
            noData: "Sin datos aÃºn"
        },
        
        fr: {
            // App & Navigation
            appTitle: "ğŸ§  Assistant de DÃ©tection des Ã‰motions et de SantÃ© Mentale",
            appSubtitle: "Projet #70: SystÃ¨me de Soutien Ã‰motionnel avec IA",
            howAreYouFeeling: "Comment vous sentez-vous aujourd'hui ?",
            
            // Input Methods
            describeFeelings: "ğŸ’¬ DÃ©crivez vos sentiments",
            speakFeelings: "ğŸ¤ Parlez de vos sentiments",
            selectExpression: "ğŸ˜Š SÃ©lectionnez une expression faciale", 
            webcamAnalysis: "ğŸ“· Analyse en Temps RÃ©el",
            textInputPlaceholder: "Dites-moi comment vous vous sentez aujourd'hui...",
            analyzeEmotion: "Analyser l'Ã‰motion",
            advancedAnalysis: "Analyse AvancÃ©e",
            startRecording: "ğŸ¤ DÃ©marrer l'Enregistrement",
            stopRecording: "â¹ï¸ ArrÃªter l'Enregistrement",
            voiceInstructions: "Cliquez sur 'DÃ©marrer l'Enregistrement' et parlez de vos sentiments",
            startCamera: "ğŸ¥ Activer la CamÃ©ra",
            captureEmotion: "ğŸ“¸ Capturer l'Ã‰motion",
            cameraInstructions: "Activez la camÃ©ra pour l'analyse faciale en temps rÃ©el",
            
            // Emotions
            happy: "Heureux",
            sad: "Triste",
            angry: "En colÃ¨re",
            surprised: "Surpris", 
            neutral: "Neutre",
            anxious: "Anxieux",
            
            // Results
            analysisResults: "RÃ©sultats de l'Analyse Ã‰motionnelle",
            emotionalBreakdown: "RÃ©partition Ã‰motionnelle :",
            supportiveResponse: "ğŸ’­ RÃ©ponse de Soutien",
            suggestionsTitle: "ğŸ’¡ Suggestions pour le bien-Ãªtre Ã©motionnel :",
            
            // Progress Tracking
            progressTitle: "ğŸ“ˆ Votre ProgrÃ¨s",
            dayStreak: "SÃ©rie de Jours",
            sessions: "Sessions", 
            achievements: "RÃ©alisations",
            
            // Mental Health Exercises
            mentalHealthExercises: "ğŸ§˜ Exercices de SantÃ© Mentale",
            breathingExercise: "Exercice de Respiration",
            breathingDescription: "Technique de respiration 4-7-8 pour soulager l'anxiÃ©tÃ©",
            quickMeditation: "MÃ©ditation Rapide",
            meditationDescription: "Pratique de pleine conscience de 5 minutes",
            progressiveRelaxation: "Relaxation Progressive",
            pmrDescription: "Technique de relaxation musculaire progressive",
            cbtExercise: "Journal des PensÃ©es TCC",
            cbtDescription: "Exercice de ThÃ©rapie Cognitivo-Comportementale",
            guidedJournaling: "Journal GuidÃ©",
            journalDescription: "RÃ©flexion Ã©motionnelle structurÃ©e",
            groundingExercise: "Technique de Grounding", 
            groundingDescription: "Grounding sensoriel 5-4-3-2-1",
            startExercise: "Commencer l'Exercice",
            stopExercise: "ArrÃªter l'Exercice",
            
            // Analytics
            analyticsTitle: "ğŸ“Š Tendances et Analyses Ã‰motionnelles",
            last7Days: "7 Derniers Jours",
            last30Days: "30 Derniers Jours",
            last90Days: "90 Derniers Jours",
            exportData: "ğŸ“¤ Exporter les DonnÃ©es",
            weeklyMood: "Distribution Hebdomadaire de l'Humeur",
            emotionFrequency: "FrÃ©quence des Ã‰motions",
            emotionalTrends: "ğŸ“ˆ Tendances Ã‰motionnelles dans le Temps",
            moodHeatmap: "ğŸ¨ Carte de Chaleur de l'Humeur",
            communityInsights: "ğŸ‘¥ Perspectives Communautaires",
            generateReport: "ğŸ“„ GÃ©nÃ©rer un Rapport RPA",
            scheduleReport: "â° Planifier les Rapports",
            
            // Session Info  
            sessionStarted: "Session dÃ©marrÃ©e :",
            interactions: "Interactions :",
            currentStreak: "SÃ©rie Actuelle :",
            resetSession: "ğŸ”„ RÃ©initialiser la Session",
            
            // Community Messages
            defaultCommunityMessage: "Vous n'Ãªtes pas seul dans votre parcours Ã©motionnel. Beaucoup de personnes trouvent du rÃ©confort dans les bilans quotidiens.",
            
            // No Data
            noData: "Pas encore de donnÃ©es"
        },
        
        de: {
            // App & Navigation  
            appTitle: "ğŸ§  Emotionserkennungs- und Mental Health-Assistent",
            appSubtitle: "Projekt #70: KI-gestÃ¼tztes emotionales UnterstÃ¼tzungssystem",
            howAreYouFeeling: "Wie fÃ¼hlst du dich heute?",
            
            // Input Methods
            describeFeelings: "ğŸ’¬ Beschreibe deine GefÃ¼hle",
            speakFeelings: "ğŸ¤ Sprich Ã¼ber deine GefÃ¼hle",
            selectExpression: "ğŸ˜Š WÃ¤hle einen Gesichtsausdruck",
            webcamAnalysis: "ğŸ“· Echtzeit-Analyse",
            textInputPlaceholder: "ErzÃ¤hle mir, wie du dich heute fÃ¼hlst...",
            analyzeEmotion: "Emotion analysieren",
            advancedAnalysis: "Erweiterte Analyse", 
            startRecording: "ğŸ¤ Aufnahme starten",
            stopRecording: "â¹ï¸ Aufnahme stoppen",
            voiceInstructions: "Klicke auf 'Aufnahme starten' und sprich Ã¼ber deine GefÃ¼hle",
            startCamera: "ğŸ¥ Kamera starten",
            captureEmotion: "ğŸ“¸ Emotion erfassen",
            cameraInstructions: "Aktiviere die Kamera fÃ¼r Echtzeit-Gesichtsanalyse",
            
            // Emotions
            happy: "GlÃ¼cklich",
            sad: "Traurig",
            angry: "WÃ¼tend",
            surprised: "Ãœberrascht", 
            neutral: "Neutral",
            anxious: "Ã„ngstlich",
            
            // Results
            analysisResults: "Emotionsanalyse-Ergebnisse",
            emotionalBreakdown: "Emotionale AufschlÃ¼sselung:",
            supportiveResponse: "ğŸ’­ UnterstÃ¼tzende Antwort",
            suggestionsTitle: "ğŸ’¡ VorschlÃ¤ge fÃ¼r emotionales Wohlbefinden:",
            
            // Progress Tracking
            progressTitle: "ğŸ“ˆ Dein Fortschritt",
            dayStreak: "Tage in Folge",
            sessions: "Sitzungen",
            achievements: "Erfolge",
            
            // Mental Health Exercises
            mentalHealthExercises: "ğŸ§˜ Mental Health-Ãœbungen",
            breathingExercise: "AtemÃ¼bung",
            breathingDescription: "4-7-8 Atemtechnik zur Linderung von AngstzustÃ¤nden",
            quickMeditation: "Schnelle Meditation",
            meditationDescription: "5-minÃ¼tige Achtsamkeitspraxis",
            progressiveRelaxation: "Progressive Entspannung",
            pmrDescription: "Technik der progressiven Muskelentspannung",
            cbtExercise: "KVT Gedankenprotokoll",
            cbtDescription: "Kognitiv-Verhaltenstherapie Ãœbung",
            guidedJournaling: "GefÃ¼hrtes Journaling",
            journalDescription: "Strukturierte emotionale Reflexion",
            groundingExercise: "Grounding-Technik",
            groundingDescription: "5-4-3-2-1 sensorisches Grounding",
            startExercise: "Ãœbung starten",
            stopExercise: "Ãœbung stoppen",
            
            // Analytics
            analyticsTitle: "ğŸ“Š Emotionale Trends & Analysen",
            last7Days: "Letzte 7 Tage",
            last30Days: "Letzte 30 Tage",
            last90Days: "Letzte 90 Tage",
            exportData: "ğŸ“¤ Daten exportieren",
            weeklyMood: "WÃ¶chentliche Stimmungsverteilung",
            emotionFrequency: "EmotionshÃ¤ufigkeit",
            emotionalTrends: "ğŸ“ˆ Emotionale Trends im Zeitverlauf",
            moodHeatmap: "ğŸ¨ Stimmungs-Hitmap",
            communityInsights: "ğŸ‘¥ Community-Einblicke",
            generateReport: "ğŸ“„ RPA-Bericht generieren",
            scheduleReport: "â° Berichte planen",
            
            // Session Info
            sessionStarted: "Sitzung gestartet:",
            interactions: "Interaktionen:",
            currentStreak: "Aktuelle Serie:",
            resetSession: "ğŸ”„ Sitzung zurÃ¼cksetzen",
            
            // Community Messages
            defaultCommunityMessage: "Du bist nicht allein auf deiner emotionalen Reise. Viele Menschen finden Trost in tÃ¤glichen Check-ins.",
            
            // No Data
            noData: "Noch keine Daten"
        }
    };

    static currentLanguage = 'en';
    static initialized = false;

    static init() {
        if (this.initialized) return;
        
        // Load saved language preference
        const savedLanguage = localStorage.getItem('preferredLanguage');
        if (savedLanguage && this.languages[savedLanguage]) {
            this.currentLanguage = savedLanguage;
        }
        
        // Set language selector
        const selector = document.getElementById('languageSelector');
        if (selector) {
            selector.value = this.currentLanguage;
            selector.addEventListener('change', (e) => {
                this.setLanguage(e.target.value);
            });
        }
        
        this.updateAllText();
        this.initialized = true;
    }

    static setLanguage(lang) {
        if (!this.languages[lang]) {
            console.warn(`Language ${lang} not supported`);
            return;
        }
        
        this.currentLanguage = lang;
        localStorage.setItem('preferredLanguage', lang);
        
        // Update selector if exists
        const selector = document.getElementById('languageSelector');
        if (selector) {
            selector.value = lang;
        }
        
        this.updateAllText();
        
        // Announce language change for accessibility
        AccessibilityManager.announce(`Language changed to ${this.getLanguageName(lang)}`);
    }

    static updateAllText() {
        // Update all elements with data-i18n attribute
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            const translation = this.t(key);
            if (translation) {
                element.textContent = translation;
            }
        });

        // Update placeholder texts
        document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
            const key = element.getAttribute('data-i18n-placeholder');
            const translation = this.t(key);
            if (translation) {
                element.setAttribute('placeholder', translation);
            }
        });

        // Update page title
        const title = this.t('appTitle');
        if (title) {
            document.title = title.replace(/^ğŸ§ \s*/, '');
        }
    }

    static t(key) {
        const keys = key.split('.');
        let value = this.languages[this.currentLanguage];
        
        for (const k of keys) {
            if (value && value[k] !== undefined) {
                value = value[k];
            } else {
                console.warn(`Translation key not found: ${key}`);
                return key; // Return the key itself if translation not found
            }
        }
        
        return value;
    }

    static getLanguageName(code) {
        const names = {
            en: 'English',
            es: 'Spanish',
            fr: 'French',
            de: 'German'
        };
        return names[code] || code;
    }

    static getSupportedLanguages() {
        return Object.keys(this.languages);
    }

    static format(text, ...args) {
        return text.replace(/{(\d+)}/g, (match, number) => {
            return typeof args[number] != 'undefined' ? args[number] : match;
        });
    }
}

// Initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    I18n.init();
});